@using HealthGateway.Common.Data.Constants
@inherits Fluxor.Blazor.Web.Components.FluxorComponent
<MudText Class="mt-4" Typo="Typo.subtitle1">
    Dataset Access
</MudText>

<MudGrid Class="mt-2">
    <MudItem xs="12">
        <MudPaper>
            <MudProgressLinear Class="rounded-t overflow-hidden" hidden="@(!IsLoading)" Color="Color.Primary" Indeterminate="true" />
            <MudCardContent Class="d-flex">
                <MudText Class="mt-2" Typo="Typo.subtitle1">
                    Dataset/Service Block
                </MudText>
            </MudCardContent>
            <MudCardContent Class="d-flex justify-start align-center">
                <MudGrid>
                    @foreach (DataSource dataSource in dataSources)
                    {
                        <MudItem xs="6" sm="4" md="3">
                            <MudSwitch
                                T="bool"
                                Label="@MapDataSourceToFriendlyText(dataSource)"
                                UnCheckedColor="Color.Tertiary"
                                Color="Color.Success"
                                Checked="@IsBlocked(dataSource)"
                                CheckedChanged="@(e => ToggleDataSource(dataSource))" />
                        </MudItem>
                    }
                </MudGrid>
            </MudCardContent>
            @if (IsDirty)
            {
                <MudCardContent Class="d-flex justify-end align-center">
                    <MudButton Variant="Variant.Outlined" Color="Color.Default" Class="mr-2" OnClick="@(e => CancelChanges())">
                        Cancel
                    </MudButton>
                    <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="@(e => SaveChanges())">
                        Save
                    </MudButton>
                </MudCardContent>
            }
        </MudPaper>
    </MudItem>
</MudGrid>
